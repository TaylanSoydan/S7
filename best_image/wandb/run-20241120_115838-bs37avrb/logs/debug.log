2024-11-20 11:58:38,264 INFO    MainThread:3517535 [wandb_setup.py:_flush():76] Current SDK version is 0.17.4
2024-11-20 11:58:38,265 INFO    MainThread:3517535 [wandb_setup.py:_flush():76] Configure stats pid to 3517535
2024-11-20 11:58:38,265 INFO    MainThread:3517535 [wandb_setup.py:_flush():76] Loading settings from /home/tsoyda/.config/wandb/settings
2024-11-20 11:58:38,265 INFO    MainThread:3517535 [wandb_setup.py:_flush():76] Loading settings from /data/tsoyda/RPG/master_thesis_taylan_soydan/event-ssm/wandb/settings
2024-11-20 11:58:38,265 WARNING MainThread:3517535 [wandb_setup.py:_flush():76] Unknown environment variable: WANDB_AGENT_MAX_INITIAL_FAILURES
2024-11-20 11:58:38,265 INFO    MainThread:3517535 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'_service_wait': '10000', 'api_key': '***REDACTED***', 'entity': 'taylansoydan', 'project': 'event-ssm', 'sweep_id': '8melnbyq', 'root_dir': '/data/tsoyda/RPG/master_thesis_taylan_soydan/event-ssm', 'run_id': 'bs37avrb', 'sweep_param_path': '/data/tsoyda/RPG/master_thesis_taylan_soydan/event-ssm/wandb/sweep-8melnbyq/config-bs37avrb.yaml'}
2024-11-20 11:58:38,265 INFO    MainThread:3517535 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-11-20 11:58:38,265 INFO    MainThread:3517535 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'run_training.py', 'program_abspath': '/data/tsoyda/RPG/master_thesis_taylan_soydan/event-ssm/run_training.py', 'program': '/data/tsoyda/RPG/master_thesis_taylan_soydan/event-ssm/run_training.py'}
2024-11-20 11:58:38,265 INFO    MainThread:3517535 [wandb_setup.py:_flush():76] Applying login settings: {}
2024-11-20 11:58:38,265 INFO    MainThread:3517535 [wandb_init.py:_log_setup():529] Logging user logs to ./outputs/2024-11-20-11-58-09/wandb/run-20241120_115838-bs37avrb/logs/debug.log
2024-11-20 11:58:38,265 INFO    MainThread:3517535 [wandb_init.py:_log_setup():530] Logging internal logs to ./outputs/2024-11-20-11-58-09/wandb/run-20241120_115838-bs37avrb/logs/debug-internal.log
2024-11-20 11:58:38,265 INFO    MainThread:3517535 [wandb_init.py:init():569] calling init triggers
2024-11-20 11:58:38,265 INFO    MainThread:3517535 [wandb_init.py:init():576] wandb.init called with sweep_config: {'model.ssm.bn_momentum': 0.95, 'model.ssm.d_model': 30, 'model.ssm.d_ssm': 48, 'model.ssm.dropout': 0.11497226575398677, 'model.ssm.num_layers_per_stage': 4, 'model.ssm.num_stages': 1, 'model.ssm.pooling_stride': 1, 'model.ssm.ssm_block_size': 4, 'model.ssm.state_expansion_factor': 1, 'model.ssm_init.bidirectional': False, 'model.ssm_init.clip_eigs': True, 'model.ssm_init.conj_sym': False, 'model.ssm_init.dt_min': 7.066894232821676e-09, 'model.ssm_init.stablessm_a': False, 'optimizer.accumulation_steps': 1, 'optimizer.lr_factor': 16, 'optimizer.proj_weight_decay': 0.016497069921660678, 'optimizer.ssm_base_lr': 7.057556033116367e-06, 'optimizer.ssm_weight_decay': 0.023777584092325364, 'optimizer.warmup_epochs': 5, 'optimizer.weight_decay': 0.07157995928590169, 'training.num_epochs': 200, 'training.per_device_batch_size': 20, 'training.per_device_eval_batch_size': 70}
config: {'seed': 1234, 'checkpoint': None, 'data_dir': '/net/cephfs/shares/rpg.ifi.uzh/tsoyda/data/dvslip', 'output_dir': './outputs/2024-11-20-11-58-09', 'checkpoint_dir': './checkpoints', 'model': {'ssm_init': {'C_init': 'lecun_normal', 'dt_min': 7.066894232821676e-09, 'dt_max': 0.1, 'conj_sym': False, 'clip_eigs': True, 'input_dependent': True, 'stablessm_a': False, 'separate_dbc': False, 'log_a': False, 'bidirectional': False}, 'ssm': {'discretization': 'zoh', 'd_model': 30, 'd_ssm': 48, 'ssm_block_size': 4, 'num_stages': 1, 'num_layers_per_stage': 4, 'dropout': 0.11497226575398677, 'classification_mode': 'pool', 'prenorm': True, 'batchnorm': True, 'bn_momentum': 0.95, 'pooling_stride': 1, 'pooling_mode': 'last', 'state_expansion_factor': 1}}, 'task': {'name': 'image-classification'}, 'training': {'num_epochs': 200, 'per_device_batch_size': 20, 'per_device_eval_batch_size': 70, 'num_workers': 40, 'cut_mix': 0.0, 'pad_unit': 1024, 'no_time_information': True}, 'optimizer': {'ssm_base_lr': 7.057556033116367e-06, 'lr_factor': 16, 'warmup_epochs': 5, 'ssm_weight_decay': 0.023777584092325364, 'weight_decay': 0.07157995928590169, 'schedule': 'cosine', 'accumulation_steps': 1, 'proj_weight_decay': 0.016497069921660678, 'total_steps': 450000, 'warmup_steps': 11250, 'ssm_lr': 0.00014115112066232736}, 'logging': {'log_dir': './outputs/2024-11-20-11-58-09', 'interval': 1000, 'wandb': True, 'summary_metric': 'Performance/Validation accuracy', 'project': 'thesis', 'entity': 'taylansoydan'}}
2024-11-20 11:58:38,266 INFO    MainThread:3517535 [wandb_init.py:init():619] starting backend
2024-11-20 11:58:38,266 INFO    MainThread:3517535 [wandb_init.py:init():623] setting up manager
2024-11-20 11:58:38,273 INFO    MainThread:3517535 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-11-20 11:58:38,287 INFO    MainThread:3517535 [wandb_init.py:init():631] backend started and connected
2024-11-20 11:58:38,295 INFO    MainThread:3517535 [wandb_run.py:_config_callback():1382] config_cb None None {'model.ssm.bn_momentum': 0.95, 'model.ssm.d_model': 30, 'model.ssm.d_ssm': 48, 'model.ssm.dropout': 0.11497226575398677, 'model.ssm.num_layers_per_stage': 4, 'model.ssm.num_stages': 1, 'model.ssm.pooling_stride': 1, 'model.ssm.ssm_block_size': 4, 'model.ssm.state_expansion_factor': 1, 'model.ssm_init.bidirectional': False, 'model.ssm_init.clip_eigs': True, 'model.ssm_init.conj_sym': False, 'model.ssm_init.dt_min': 7.066894232821676e-09, 'model.ssm_init.stablessm_a': False, 'optimizer.accumulation_steps': 1, 'optimizer.lr_factor': 16, 'optimizer.proj_weight_decay': 0.016497069921660678, 'optimizer.ssm_base_lr': 7.057556033116367e-06, 'optimizer.ssm_weight_decay': 0.023777584092325364, 'optimizer.warmup_epochs': 5, 'optimizer.weight_decay': 0.07157995928590169, 'training.num_epochs': 200, 'training.per_device_batch_size': 20, 'training.per_device_eval_batch_size': 70}
2024-11-20 11:58:38,297 INFO    MainThread:3517535 [wandb_init.py:init():720] updated telemetry
2024-11-20 11:58:38,318 INFO    MainThread:3517535 [wandb_init.py:init():753] communicating run to backend with 90.0 second timeout
2024-11-20 11:58:38,717 INFO    MainThread:3517535 [wandb_run.py:_on_init():2402] communicating current version
2024-11-20 11:58:38,803 INFO    MainThread:3517535 [wandb_run.py:_on_init():2411] got version response upgrade_message: "wandb version 0.18.7 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-11-20 11:58:38,804 INFO    MainThread:3517535 [wandb_init.py:init():804] starting run threads in backend
2024-11-20 11:58:39,333 INFO    MainThread:3517535 [wandb_run.py:_console_start():2380] atexit reg
2024-11-20 11:58:39,333 INFO    MainThread:3517535 [wandb_run.py:_redirect():2235] redirect: wrap_raw
2024-11-20 11:58:39,333 INFO    MainThread:3517535 [wandb_run.py:_redirect():2300] Wrapping output streams.
2024-11-20 11:58:39,333 INFO    MainThread:3517535 [wandb_run.py:_redirect():2325] Redirects installed.
2024-11-20 11:58:39,339 INFO    MainThread:3517535 [wandb_init.py:init():847] run started, returning control to user process
2024-11-20 11:58:39,340 INFO    MainThread:3517535 [wandb_run.py:_config_callback():1382] config_cb None None {'SLURM_JOB_ID': '18290841'}
2024-11-20 18:58:36,373 WARNING MsgRouterThr:3517535 [router.py:message_loop():77] message_loop has been closed
