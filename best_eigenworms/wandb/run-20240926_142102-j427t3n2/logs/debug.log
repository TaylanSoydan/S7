2024-09-26 14:21:02,038 INFO    MainThread:2924776 [wandb_setup.py:_flush():76] Current SDK version is 0.17.4
2024-09-26 14:21:02,038 INFO    MainThread:2924776 [wandb_setup.py:_flush():76] Configure stats pid to 2924776
2024-09-26 14:21:02,038 INFO    MainThread:2924776 [wandb_setup.py:_flush():76] Loading settings from /home/tsoyda/.config/wandb/settings
2024-09-26 14:21:02,038 INFO    MainThread:2924776 [wandb_setup.py:_flush():76] Loading settings from /data/tsoyda/RPG/master_thesis_taylan_soydan/event-ssm/wandb/settings
2024-09-26 14:21:02,038 WARNING MainThread:2924776 [wandb_setup.py:_flush():76] Unknown environment variable: WANDB_AGENT_MAX_INITIAL_FAILURES
2024-09-26 14:21:02,038 INFO    MainThread:2924776 [wandb_setup.py:_flush():76] Loading settings from environment variables: {'_service_wait': '10000', 'api_key': '***REDACTED***', 'entity': 'taylansoydan', 'project': 'event-ssm', 'sweep_id': 'mfi5tvf7', 'root_dir': '/data/tsoyda/RPG/master_thesis_taylan_soydan/event-ssm', 'run_id': 'j427t3n2', 'sweep_param_path': '/data/tsoyda/RPG/master_thesis_taylan_soydan/event-ssm/wandb/sweep-mfi5tvf7/config-j427t3n2.yaml'}
2024-09-26 14:21:02,038 INFO    MainThread:2924776 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-09-26 14:21:02,038 INFO    MainThread:2924776 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'run_training.py', 'program_abspath': '/data/tsoyda/RPG/master_thesis_taylan_soydan/event-ssm/run_training.py', 'program': '/data/tsoyda/RPG/master_thesis_taylan_soydan/event-ssm/run_training.py'}
2024-09-26 14:21:02,038 INFO    MainThread:2924776 [wandb_setup.py:_flush():76] Applying login settings: {}
2024-09-26 14:21:02,038 INFO    MainThread:2924776 [wandb_init.py:_log_setup():529] Logging user logs to ./outputs/2024-09-26-14-20-47/wandb/run-20240926_142102-j427t3n2/logs/debug.log
2024-09-26 14:21:02,038 INFO    MainThread:2924776 [wandb_init.py:_log_setup():530] Logging internal logs to ./outputs/2024-09-26-14-20-47/wandb/run-20240926_142102-j427t3n2/logs/debug-internal.log
2024-09-26 14:21:02,038 INFO    MainThread:2924776 [wandb_init.py:init():569] calling init triggers
2024-09-26 14:21:02,038 INFO    MainThread:2924776 [wandb_init.py:init():576] wandb.init called with sweep_config: {'model.ssm.bn_momentum': 0.95, 'model.ssm.classification_mode': 'pool', 'model.ssm.d_model': 36, 'model.ssm.d_ssm': 8, 'model.ssm.discretization': 'zoh', 'model.ssm.dropout': 0.19493287684529745, 'model.ssm.num_layers_per_stage': 1, 'model.ssm.num_stages': 1, 'model.ssm.pooling_stride': 1, 'model.ssm.ssm_block_size': 4, 'model.ssm.state_expansion_factor': 1, 'model.ssm_init.bidirectional': False, 'model.ssm_init.clip_eigs': True, 'model.ssm_init.conj_sym': False, 'model.ssm_init.dt_max': 0.1, 'model.ssm_init.dt_min': 0.001, 'model.ssm_init.input_dependent': True, 'model.ssm_init.separate_dbc': False, 'model.ssm_init.stablessm_a': False, 'optimizer.accumulation_steps': 1, 'optimizer.lr_factor': 4, 'optimizer.proj_weight_decay': 0.03203944987024569, 'optimizer.ssm_base_lr': 0.0003204789646136706, 'optimizer.ssm_weight_decay': 0.02275975287136827, 'optimizer.warmup_epochs': 1, 'optimizer.weight_decay': 0.029755403494251292, 'training.num_epochs': 1600, 'training.per_device_batch_size': 6, 'training.per_device_eval_batch_size': 20}
config: {'seed': 1234, 'checkpoint': None, 'data_dir': '/net/cephfs/shares/rpg.ifi.uzh/tsoyda/data/dvslip', 'output_dir': './outputs/2024-09-26-14-20-47', 'checkpoint_dir': './checkpoints', 'model': {'ssm_init': {'C_init': 'lecun_normal', 'dt_min': 0.001, 'dt_max': 0.1, 'conj_sym': False, 'clip_eigs': True, 'input_dependent': True, 'stablessm_a': False, 'separate_dbc': False, 'log_a': False, 'bidirectional': False}, 'ssm': {'discretization': 'zoh', 'd_model': 36, 'd_ssm': 8, 'ssm_block_size': 4, 'num_stages': 1, 'num_layers_per_stage': 1, 'dropout': 0.19493287684529745, 'classification_mode': 'pool', 'prenorm': True, 'batchnorm': True, 'bn_momentum': 0.95, 'pooling_stride': 1, 'pooling_mode': 'last', 'state_expansion_factor': 1, 'encoder_type': 'dense'}}, 'task': {'name': 'eigenworms-classification'}, 'training': {'num_epochs': 1600, 'per_device_batch_size': 6, 'per_device_eval_batch_size': 20, 'num_workers': 16, 'cut_mix': 0.0, 'pad_unit': 17984, 'no_time_information': True}, 'optimizer': {'ssm_base_lr': 0.0003204789646136706, 'lr_factor': 4, 'warmup_epochs': 1, 'ssm_weight_decay': 0.02275975287136827, 'weight_decay': 0.029755403494251292, 'schedule': 'cosine', 'accumulation_steps': 1, 'proj_weight_decay': 0.03203944987024569, 'total_steps': 48000, 'warmup_steps': 30, 'ssm_lr': 0.0019228737876820236}, 'logging': {'log_dir': './outputs/2024-09-26-14-20-47', 'interval': 500, 'wandb': True, 'summary_metric': 'Performance/Validation accuracy', 'project': 'thesis', 'entity': 'taylansoydan'}}
2024-09-26 14:21:02,038 INFO    MainThread:2924776 [wandb_init.py:init():619] starting backend
2024-09-26 14:21:02,038 INFO    MainThread:2924776 [wandb_init.py:init():623] setting up manager
2024-09-26 14:21:02,042 INFO    MainThread:2924776 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-09-26 14:21:02,043 INFO    MainThread:2924776 [wandb_init.py:init():631] backend started and connected
2024-09-26 14:21:02,050 INFO    MainThread:2924776 [wandb_run.py:_config_callback():1382] config_cb None None {'model.ssm.bn_momentum': 0.95, 'model.ssm.classification_mode': 'pool', 'model.ssm.d_model': 36, 'model.ssm.d_ssm': 8, 'model.ssm.discretization': 'zoh', 'model.ssm.dropout': 0.19493287684529745, 'model.ssm.num_layers_per_stage': 1, 'model.ssm.num_stages': 1, 'model.ssm.pooling_stride': 1, 'model.ssm.ssm_block_size': 4, 'model.ssm.state_expansion_factor': 1, 'model.ssm_init.bidirectional': False, 'model.ssm_init.clip_eigs': True, 'model.ssm_init.conj_sym': False, 'model.ssm_init.dt_max': 0.1, 'model.ssm_init.dt_min': 0.001, 'model.ssm_init.input_dependent': True, 'model.ssm_init.separate_dbc': False, 'model.ssm_init.stablessm_a': False, 'optimizer.accumulation_steps': 1, 'optimizer.lr_factor': 4, 'optimizer.proj_weight_decay': 0.03203944987024569, 'optimizer.ssm_base_lr': 0.0003204789646136706, 'optimizer.ssm_weight_decay': 0.02275975287136827, 'optimizer.warmup_epochs': 1, 'optimizer.weight_decay': 0.029755403494251292, 'training.num_epochs': 1600, 'training.per_device_batch_size': 6, 'training.per_device_eval_batch_size': 20}
2024-09-26 14:21:02,051 INFO    MainThread:2924776 [wandb_init.py:init():720] updated telemetry
2024-09-26 14:21:02,055 INFO    MainThread:2924776 [wandb_init.py:init():753] communicating run to backend with 90.0 second timeout
2024-09-26 14:21:02,416 INFO    MainThread:2924776 [wandb_run.py:_on_init():2402] communicating current version
2024-09-26 14:21:02,481 INFO    MainThread:2924776 [wandb_run.py:_on_init():2411] got version response upgrade_message: "wandb version 0.18.1 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2024-09-26 14:21:02,481 INFO    MainThread:2924776 [wandb_init.py:init():804] starting run threads in backend
2024-09-26 14:21:02,627 INFO    MainThread:2924776 [wandb_run.py:_console_start():2380] atexit reg
2024-09-26 14:21:02,627 INFO    MainThread:2924776 [wandb_run.py:_redirect():2235] redirect: wrap_raw
2024-09-26 14:21:02,627 INFO    MainThread:2924776 [wandb_run.py:_redirect():2300] Wrapping output streams.
2024-09-26 14:21:02,627 INFO    MainThread:2924776 [wandb_run.py:_redirect():2325] Redirects installed.
2024-09-26 14:21:02,629 INFO    MainThread:2924776 [wandb_init.py:init():847] run started, returning control to user process
2024-09-26 14:21:02,629 INFO    MainThread:2924776 [wandb_run.py:_config_callback():1382] config_cb None None {'SLURM_JOB_ID': '16432506'}
2024-09-26 16:05:36,527 WARNING MsgRouterThr:2924776 [router.py:message_loop():77] message_loop has been closed
